---
title: "二项式和容斥原理学习笔记"
description: "如题"
pubDate: "Dec 23 2024"
image: "/head_pic/Nahida_2.webp"
categories:
  - tech
tags:
  - 学习笔记
---

因为这b玩意实在是太难了，所以我得边学边记笔记。

## 二项式定理

二项式，就是有两项的多项式。形如：

$$
a + b 
$$

很简单吧？现在我们来考虑这个东西：

$$
(a + b) ^ i
$$

这十分的让人迷惑对吧？没事，我们先来看看低次的：

$$
\begin{aligned}
(a + b) ^ 0 & = 1 \\ 
(a + b) ^ 1 & = a^1 + b^1 \\
(a + b) ^ 2 & = a^2 + 2a^1b^1 + b^2 \\
(a + b) ^ 3 & = a^3 + 3a^2b^1 + 3a^1b^2 + b^3
\end{aligned}
$$

似乎有点规律？我们先不管系数，看指数，猛地发现：

$$
\begin{aligned}
(a + b)^i & = ?a^i b^0 + ?a^{i - 1}b^1 + ?a^{i - 2}b^2 + \cdots + ?a^0b^i \\
& = \sum\limits_{j = 0}^{i}?a^j b^{i - j}
\end{aligned}
$$

我们再把每一行的每一项系数列出来？

$$
1 \\
1 \; 1 \\
1 \; 2 \; 1 \\
1 \; 3 \; 3 \; 1
$$

这不就是杨辉三角吗？而杨辉三角又可以写成这样：

$$
\binom{0}{0} \\
\binom{1}{0} \; \binom{1}{1} \\
\binom{2}{0} \; \binom{2}{1} \; \binom{2}{2} \\
\binom{3}{0} \; \binom{3}{1} \; \binom{3}{2} \; \binom{3}{3} 
$$

也就是说：杨辉三角的第 $i$ 行第 $j$ 个数是 $\binom{i}{j}$ 。这里，行和列都是从 $0$ 开始标号的。而回到上面的式子，我们发现，$(a + b)^i$ 的第 $j$ 项的系数是杨辉三角的 第 $i$ 行第 $j$ 个数，也就是 $\binom{i}{j}$。那么，我们便可以写出公式：

$$
(a + b) ^ i = \sum\limits_{j = 0}^{i}\binom{i}{j}a^j b^{i - j}
$$

这便是二项式定理了。

## 二项式反演

### 例子

先从基础~~不了一点~~的容斥开始。举个例子：  
现在有三个性质：$P_{1},P_{2},P_{3}$，满足这三个性质的元素分别属于 $S_{1},S_{2},S_{3}$。然后要我们求 $|S_{1} \cup S_{2} \cup S_{3}|$。最简单的情况当然是他们两两都没有交集，那样子的答案就是 $|S_{1}| + |S_{2}| + |S_{3}|$。但是，现实里，题目里，怎么可能都这么简单呢？于是乎我们考虑有交集的情况。先来画一个韦恩图：

![](https://sigewinne.us/pic_in_blog/二项式and容斥原理学习笔记/韦恩图.webp)

显然，三个红色部分分别加上绿色部分分别代表 $S_{1} \cap S_{2},S_{2} \cap S_{3},S_{1} \cap S_{3}$ 。中间的绿色部分代表 $S_{1} \cap S_{2} \cap S_{3}$ 。那么我们看，我们的柿子：$|S_{1}| + |S_{2}| + |S_{3}|$，很明显把每一块红色部分加绿色部分都多算了一遍，于是我们就考虑将多算的减去：$|S_{1}| + |S_{2}| + |S_{3}| - |S_{1} \cap S_{2}| - |S_{2} \cap S_{3}| - |S_{1} \cap S_{3}|$。但是，我们又发现，中间那一块似乎没算到，所以我们就要把绿色部分再算一次：$|S_{1}| + |S_{2}| + |S_{3}| - |S_{1} \cap S_{2}| - |S_{2} \cap S_{3}| - |S_{1} \cap S_{3}| + |S_{1} \cap S_{2} \cap S_{3}|$ ，这样我们就求得了 $|S_{1} \cup S_{2} \cup S_{3}|$。

刚刚是图形证法，现在我们来考虑用数学证法。我们把 $S_{1} \cup S_{2}$ 看作一个整体，那么 $S_{3}$ 想要加入就是 $|S_{1} \cup S_{2}| + |S_{3}| - |(S_{1} \cup S_{2}) \cap S_{3}|$。然后我们把它拆开：

$$
\begin{aligned}
& |S_{1}| + |S_{2}| - |S_{1} \cap S_{2}| + |S_{3}| + |(S_{1} \cap S_{3}) \cup (S_{2} \cap S_{3})| \\
= & |S_{1}| + |S_{2}| - |S_{1} \cap S_{2}| + |S_{3}| - |S_{1} \cap S_{3}| - |S_{2} \cap S_{3}| + |(S_{1} \cap S_{3}) \cap (S_{2} \cap S_{3})| \\
= & |S_{1}| + |S_{2}| + |S_{3}| - |S_{1} \cap S_{2}| - |S_{2} \cap S_{3}| - |S_{1} \cap S_{3}| + |S_{1} \cap S_{2} \cap S_{3}|
\end{aligned}
$$

然后我们就成功的用数学方法证出了这个结论。

## 容斥原理

先说结论：

$$
\begin{aligned} |\bigcup\limits_{i = 1}^{n}S_{i}| 
& = \sum_{i = 1}^{n}|S_{i}| - \sum\limits_{1 \le i < j \le n}|S{i} \cap S_{j}| + \sum\limits_{1 \le i < j < k \le n}|S_{i} \cap S_{j} \cap S_{k}| + \cdots + (-1)^{m - 1}\sum\limits_{a_{i} < a_{i - 1}}|\bigcap_{k = 1}^{m}S_{a_{k}}| + \cdots + (-1)^{n - 1}|\bigcap_{i = 1}^{n}S_{i}| \\
& = \sum\limits_{m = 1}^{n}(-1)^{m - 1}\sum\limits_{a_i < a_{i - 1}}|\bigcap_{i = 1}^{m}S_{a_{i}}|
\end{aligned}
$$